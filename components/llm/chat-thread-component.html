<div class="chat-thread-component">
    <div class="input-group">
        <div class="button-bar button-bar--small button-bar--center">
            <button @click="$refs.llmSettingsDialog.show(true)" title="Settings">
                <icon-component name="settings"></icon-component>
            </button>
            <button @click="scrollToTop()" title="Scroll to top">
                <icon-component name="arrow_upward"></icon-component>
            </button>
            <button @click="scrollToBottom()" title="Scroll to bottom">
                <icon-component name="arrow_downward"></icon-component>
            </button>
            <button @click="showDebugInfo = !showDebugInfo" title="Toggle Debug Info">
                <icon-component v-if="showDebugInfo" name="show"></icon-component>
                <icon-component v-else name="hide"></icon-component>
            </button>
            <button @click="thread.clear(true)" title="Clear" class="button--danger">
                <icon-component name="delete"></icon-component>
            </button>
        </div>
        <dialog-component ref="llmSettingsDialog" title="LLM Settings">
            <llm-settings-component></llm-settings-component>
        </dialog-component>
    </div>
    <div class="chat-thread-component__thread" ref="threadContainerRef">
        <div v-for="bead of thread.beads"
            :class="`chat-thread-component__bead chat-thread-component__bead--${bead.role}`"
            :hidden="!showDebugInfo && bead.isDebug">
            <div class="chat-thread-component__role" v-text="bead.friendlyRole"></div>
            <markdown-component
                v-if="bead.content"
                class="frost
                chat-thread-component__contents"
                :markdown="bead.content">
            </markdown-component>
            <code v-if="showDebugInfo && bead.usage">
                <span class="const" title="delay">{{ bead.usage.duration }}</span>
                <span class="exprs">ms</span>
                <span class="punct">, </span>
                <span class="const" title="Promps tokens" v-text="bead.usage.prompt_tokens"></span>
                <span class="exprs">Tok</span>
                <span class="punct">, </span>
                <span class="const" title="Completion tokens" v-text="bead.usage.completion_tokens"></span>
                <span class="exprs">Tok</span>
                <span class="punct">, </span>
                <span class="const" title="Throughput">
                    {{ (1000 * bead.usage.completion_tokens / bead.usage.duration).toFixed(1) }}
                </span>
                <span class="exprs">Tok/s</span>
            </code>
        </div>
        <loading-animation-component v-if="isBusy"></loading-animation-component>
        </div>
</div>